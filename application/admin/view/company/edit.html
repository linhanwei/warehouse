{extend name="public/base" /}
{block name="main"}
    <div class="widget-box">
        <div class="widget-title">
            <span class="icon"><a href="<{:url('company/index')}>"><i class="fa fa-chevron-left"></i>返回</a></span>
            <h5>企业修改</h5>
        </div>
        <div class="widget-content container-fluid">
            <form class="form-horizontal" id="commentForm2" novalidate="novalidate" method="post" action="">
                <{:token()}>
                <input type="hidden" name="id" value="<{$companyInfo.id}>">
                <div class="form-group col-sm-6">
                    <label class="col-sm-4 control-label">企业名称：</label>
                    <div class="col-sm-8">
                        <input name="name" value="<{$companyInfo.name}>" datatype="*" nullmsg="请输入企业名称" class="form-control" type="text" placeholder="请输入企业名称" />
                    </div>
                </div>
                <div class="form-group col-sm-6">
                    <label class="col-sm-4 control-label">法人：</label>
                    <div class="col-sm-8">
                        <input name="legal_person" value="<{$companyInfo.legal_person}>" datatype="*" nullmsg="请输入法人" class="form-control" type="text" placeholder="请输入法人" />
                    </div>
                </div>
                <div class="hr-line-dashed"></div>
                <div class="form-group col-sm-6">
                    <label class="col-sm-4 control-label">注册资本(万元)：</label>
                    <div class="col-sm-8">
                        <input name="reg_capital" value="<{$companyInfo.reg_capital}>" datatype="n" nullmsg="请输入注册资本" class="form-control" type="text" placeholder="请输入注册资本" />
                    </div>
                </div>
                <div class="form-group col-sm-6">
                        <label class="col-sm-4 control-label">对公账户：</label>
                        <div class="col-sm-8">
                            <input name="public_account" value="<{$companyInfo.public_account}>" datatype="n" nullmsg="请输入对公账户" class="form-control" type="text" placeholder="请输入对公账户" />
                        </div>
                </div>
                <div class="hr-line-dashed"></div>
                <div class="form-group col-sm-6">
                    <label class="col-sm-4 control-label">对公银行：</label>
                    <div class="col-sm-8">
                        <select name="bank_id" class="form-control">
                            <!--<option value="">请选择</option>-->
                            {volist name="bankList" id="bank"}
                                <option value="<{$bank.id}>" {if condition="$bank.id eq $companyInfo.bank_id"}selected{/if} ><{$bank.name}></option>
                            {/volist}
                        </select>
                    </div>
                </div>
                <div class="form-group col-sm-6">
                    <label class="col-sm-4 control-label">联系人：</label>
                    <div class="col-sm-8">
                        <input name="contacts" value="<{$companyInfo.contacts}>" datatype="*" nullmsg="请输入联系人" class="form-control" type="text" placeholder="请输入联系人" />
                    </div>
                </div>
                <div class="hr-line-dashed"></div>
                <div class="form-group col-sm-6">
                    <label class="col-sm-4 control-label">手机号码：</label>
                    <div class="col-sm-8">
                        <input name="mobile" value="<{$companyInfo.mobile}>" datatype="<{$Think.VALIDATE_MOBILE_REGX}>" nullmsg="请输入手机号码" class="form-control" type="text" placeholder="请输入手机号码" />
                    </div>
                </div>
                <div class="form-group col-sm-6">
                    <label class="col-sm-4 control-label">固定号码：</label>
                    <div class="col-sm-8">
                        <input name="tel" value="<{$companyInfo.tel}>" class="form-control" type="text" placeholder="请输入固定号码" />
                    </div>
                </div>
                <div class="hr-line-dashed"></div>.
                <div class="form-group col-sm-6">
                    <label class="col-sm-4 control-label">邮箱：</label>
                    <div class="col-sm-8">
                        <input name="email" value="<{$companyInfo.email}>" datatype="e" ignore="ignore" class="form-control" type="text" placeholder="请输入邮箱" />
                    </div>
                </div>
                <div class="form-group col-sm-6">
                    <label class="col-sm-4 control-label">工商注册号：</label>
                    <div class="col-sm-8">
                        <input name="business_circles_number" value="<{$companyInfo.business_circles_number}>" datatype="*" class="form-control" type="text" nullmsg="请输入工商注册号" placeholder="请输入工商注册号" />
                    </div>
                </div>
                <div class="hr-line-dashed"></div>.
                <div class="form-group col-sm-12">
                    <label class="col-sm-2 control-label">企业地址：</label>
                    <div class="col-sm-2">
                        <select name="province_id" id="province" class="form-control" datatype="*" nullmsg="请选择省份">
                            <option value="">请选择省份</option>
                            {volist name="provinceList" id="province"}
                                <option value="<{$province.id}>" {if condition="$province.id eq $companyInfo.province_id"}selected{/if} ><{$province.region_name}></option>
                            {/volist}
                        </select>
                    </div>
                    <div class="col-sm-2">
                        <select name="city_id" id="city" class="form-control" datatype="*" nullmsg="请选择市">
                            <option value="">请选择市</option>
                            {volist name="cityList" id="city"}
                                <option value="<{$city.id}>" {if condition="$city.id eq $companyInfo.city_id"}selected{/if} ><{$city.region_name}></option>
                            {/volist}
                        </select>
                    </div>
                    <div class="col-sm-2">
                        <select name="district_id" id="district" class="form-control" datatype="*" nullmsg="请选择区县">
                            <option value="">请选择区县</option>
                            {volist name="districtList" id="district"}
                                <option value="<{$district.id}>" {if condition="$district.id eq $companyInfo.district_id"}selected{/if} ><{$district.region_name}></option>
                            {/volist}
                        </select>
                    </div>
                    <div class="col-sm-4">
                       <input name="address" value="<{$companyInfo.address}>"  datatype="*" nullmsg="请输入详细地址" class="form-control" type="text" placeholder="请输入详细地址" />
                    </div>
                </div>
                <div class="hr-line-dashed"></div>
                <div class="form-group uploader-group col-sm-6" data-multiple="true" data-auto="true" data-len="1" data-size="<{$Think.UPLOAD_IMAGE_SIZE}>" data-status="edit">
                    <label class="col-sm-4 control-label">营业执照:</label>
                    <div class="col-sm-8">
                        <!--用来存放文件信息-->
                        <div class="uploader-list">
                            {volist name="companyInfo.business_license_img" id="business_license_img" }
                                <div id="WU_FILE_<{$i+20}>" class="item img-item pull-left" style="margin-bottom:10px;margin-right:10px;">
                                    <img style="width:100px;height:100px;" src="<{$Think.IMAGE_URL}><{$business_license_img}>">
                                    <i class="fa fa-close close-btn"></i>
                                    <div class="progress progress-striped active" style="display: none;">
                                        <div class="progress-bar" role="progressbar" style="width: 100%;"></div>
                                    </div>
                                    <input type="hidden" name="business_license_img[]" value="<{$business_license_img}>" class="hid-filename">
                                </div>
                            {/volist}
                        </div>
                        <a class="btn btn-dark uploader-picker" data-file="business_license_img" data-type="image"><i class="fa fa-upload"></i> 选择文件</a>
                        <span class="help-block"><i class="fa fa-info-circle"></i>最大只能上传<{$Think.UPLOAD_IMAGE_SIZE}>M的图片</span>
                        <input type="hidden" datatype="fileLen" valu="" nullmsg="请至少上传一个文件">
                    </div>
                </div>
                <div class="hr-line-dashed"></div>
                <div class="form-group uploader-group col-sm-6" data-multiple="true" data-auto="true" data-len="0" data-size="<{$Think.UPLOAD_IMAGE_SIZE}>" data-status="edit">
                    <label class="col-sm-4 control-label">商标证:</label>
                    <div class="col-sm-8">
                        <!--用来存放文件信息-->
                        <div class="uploader-list">
                            {volist name="companyInfo.trademark_img" id="trademark_img" }
                                <div id="WU_FILE_<{$i+30}>" class="item img-item pull-left" style="margin-bottom:10px;margin-right:10px;">
                                    <img style="width:100px;height:100px;" src="<{$Think.IMAGE_URL}><{$trademark_img}>">
                                    <i class="fa fa-close close-btn"></i>
                                    <div class="progress progress-striped active" style="display: none;">
                                        <div class="progress-bar" role="progressbar" style="width: 100%;"></div>
                                    </div>
                                    <input type="hidden" name="trademark_img[]" value="<{$trademark_img}>" class="hid-filename">
                                </div>
                            {/volist}
                        </div>
                        <a class="btn btn-dark uploader-picker" data-file="trademark_img" data-type="image"><i class="fa fa-upload"></i> 选择文件</a>
                        <span class="help-block"><i class="fa fa-info-circle"></i>最大只能上传<{$Think.UPLOAD_IMAGE_SIZE}>M的图片</span>
                    </div>
                </div>
                <div class="hr-line-dashed"></div>
                <div class="form-group uploader-group col-sm-6" data-multiple="true" data-auto="true" data-len="0" data-size="<{$Think.UPLOAD_IMAGE_SIZE}>" data-status="edit">
                    <label class="col-sm-4 control-label">其他:</label>
                    <div class="col-sm-8">
                        <!--用来存放文件信息-->
                        <div class="uploader-list">
                            {volist name="companyInfo.other_img" id="other_img" }
                                <div id="WU_FILE_<{$i+40}>" class="item img-item pull-left" style="margin-bottom:10px;margin-right:10px;">
                                    <img style="width:100px;height:100px;" src="<{$Think.IMAGE_URL}><{$other_img}>">
                                    <i class="fa fa-close close-btn"></i>
                                    <div class="progress progress-striped active" style="display: none;">
                                        <div class="progress-bar" role="progressbar" style="width: 100%;"></div>
                                    </div>
                                    <input type="hidden" name="other_img[]" value="<{$other_img}>" class="hid-filename">
                                </div>
                            {/volist}
                        </div>
                        <a class="btn btn-dark uploader-picker" data-file="other_img" data-type="image"><i class="fa fa-upload"></i> 选择文件</a>
                        <span class="help-block"><i class="fa fa-info-circle"></i>最大只能上传<{$Think.UPLOAD_IMAGE_SIZE}>M的图片</span>
                    </div>
                </div>
                <div class="hr-line-dashed"></div>
                <div class="form-group">
                    <div class="col-sm-8 col-sm-offset-3">
                        <button class="btn btn-success" type="submit">提交</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
{/block}
{block name="js"}
    <script src="/static/admin/js/validform.js" type="text/javascript" ></script>
    <script src="/static/admin/js/newvalidform.js" type="text/javascript" ></script>
    <script src="/static/admin/webuploader/webuploader.min.js"></script>
    <script src="/static/admin/js/webuploader.own.js"></script>
    <script>
        $(function () {

            //搜索市
            $('#province').change(function () {
                get_area_list($(this).val(),'city');
            });

            //搜索区县
            $('#city').change(function () {
                get_area_list($(this).val(),'district');
            });
        });

        //获取省份
        function get_area_list(pid,ele_id)
        {
            $.get('<{:url("region/getRegionList")}>',{pid:pid},function (return_data) {
                if(return_data.status == 1)
                {
                    if(ele_id == 'city')
                    {
                        var select_msg = '请选择市';
                    }
                    else
                    {
                        var select_msg = '请选择区县';
                    }
                    var data = return_data.data,
                        html = '<option value="">'+select_msg+'</option>';
                    for (var k in data)
                    {
                        html += '<option value="'+data[k].id+'">'+data[k].region_name+'</option>';
                    }

                    $('#'+ele_id).html(html);
                }
            });
        }
    </script>
{/block}