{extend name="public/base" /}
{block name="main"}
    <div class="widget-box">
        <div class="widget-title">
            <span class="icon"><a href="<{:url('company/index')}>"><i class="fa fa-chevron-left"></i>返回</a></span>
            <h5>企业添加</h5>
        </div>
        <div class="widget-content container-fluid">
            <form class="form-horizontal" id="commentForm2" novalidate="novalidate" method="post" action="">
                <{:token()}>
                <div class="form-group col-sm-6">
                    <label class="col-sm-4 control-label">企业名称：</label>
                    <div class="col-sm-8">
                        <input name="name" datatype="*" nullmsg="请输入企业名称" class="form-control" type="text" placeholder="请输入企业名称" />
                    </div>
                </div>
                <div class="form-group col-sm-6">
                    <label class="col-sm-4 control-label">法人：</label>
                    <div class="col-sm-8">
                        <input name="legal_person" datatype="*" nullmsg="请输入法人" class="form-control" type="text" placeholder="请输入法人" />
                    </div>
                </div>
                <div class="hr-line-dashed"></div>
                <div class="form-group col-sm-6">
                    <label class="col-sm-4 control-label">注册资本(万元)：</label>
                    <div class="col-sm-8">
                        <input name="reg_capital" datatype="n" nullmsg="请输入注册资本" class="form-control" type="text" placeholder="请输入注册资本" />
                    </div>
                </div>
                <div class="form-group col-sm-6">
                        <label class="col-sm-4 control-label">对公账户：</label>
                        <div class="col-sm-8">
                            <input name="public_account" datatype="n" nullmsg="请输入对公账户" class="form-control" type="text" placeholder="请输入对公账户" />
                        </div>
                </div>
                <div class="hr-line-dashed"></div>
                <div class="form-group col-sm-6">
                    <label class="col-sm-4 control-label">对公银行：</label>
                    <div class="col-sm-8">
                        <select name="bank_id" class="form-control">
                            <!--<option value="">请选择</option>-->
                            {volist name="bankList" id="bank"}
                                <option value="<{$bank.id}>"><{$bank.name}></option>
                            {/volist}
                        </select>
                    </div>
                </div>
                <div class="form-group col-sm-6">
                    <label class="col-sm-4 control-label">联系人：</label>
                    <div class="col-sm-8">
                        <input name="contacts" datatype="*" nullmsg="请输入联系人" class="form-control" type="text" placeholder="请输入联系人" />
                    </div>
                </div>
                <div class="hr-line-dashed"></div>
                <div class="form-group col-sm-6">
                    <label class="col-sm-4 control-label">手机号码：</label>
                    <div class="col-sm-8">
                        <input name="mobile" datatype="<{$Think.VALIDATE_MOBILE_REGX}>" nullmsg="请输入手机号码" class="form-control" type="text" placeholder="请输入手机号码" />
                    </div>
                </div>
                <div class="form-group col-sm-6">
                    <label class="col-sm-4 control-label">固定号码：</label>
                    <div class="col-sm-8">
                        <input name="tel" class="form-control" type="text" placeholder="请输入固定号码" />
                    </div>
                </div>
                <div class="hr-line-dashed"></div>.
                <div class="form-group col-sm-6">
                    <label class="col-sm-4 control-label">邮箱：</label>
                    <div class="col-sm-8">
                        <input name="email" datatype="e" ignore="ignore" class="form-control" type="text" placeholder="请输入邮箱" />
                    </div>
                </div>
                <div class="form-group col-sm-6">
                    <label class="col-sm-4 control-label">工商注册号：</label>
                    <div class="col-sm-8">
                        <input name="business_circles_number" datatype="*" class="form-control" type="text" nullmsg="请输入工商注册号" placeholder="请输入工商注册号" />
                    </div>
                </div>
                <div class="hr-line-dashed"></div>.
                <div class="form-group col-sm-12">
                    <label class="col-sm-2 control-label">企业地址：</label>
                    <div class="col-sm-2">
                        <select name="province_id" id="province" class="form-control" datatype="*" nullmsg="请选择省份">
                            <option value="">请选择省份</option>
                            {volist name="provinceList" id="province"}
                                <option value="<{$province.id}>"><{$province.region_name}></option>
                            {/volist}
                        </select>
                    </div>
                    <div class="col-sm-2">
                        <select name="city_id" id="city" class="form-control" datatype="*" nullmsg="请选择市">
                            <option value="">请选择市</option>
                        </select>
                    </div>
                    <div class="col-sm-2">
                        <select name="district_id" id="district" class="form-control" datatype="*" nullmsg="请选择区县">
                            <option value="">请选择区县</option>
                        </select>
                    </div>
                    <div class="col-sm-4">
                       <input name="address" datatype="*" nullmsg="请输入详细地址" class="form-control" type="text" placeholder="请输入详细地址" />
                    </div>
                </div>
                <div class="hr-line-dashed"></div>
                <div class="form-group uploader-group col-sm-6" data-multiple="true" data-auto="true" data-len="1" data-size="<{$Think.UPLOAD_IMAGE_SIZE}>" >
                    <label class="col-sm-4 control-label">营业执照:</label>
                    <div class="col-sm-8">
                        <!--用来存放文件信息-->
                        <div class="uploader-list"></div>
                        <a class="btn btn-dark uploader-picker" data-file="business_license_img" data-type="image"><i class="fa fa-upload"></i> 选择文件</a>
                        <span class="help-block"><i class="fa fa-info-circle"></i>最大只能上传<{$Think.UPLOAD_IMAGE_SIZE}>M的图片</span>
                        <input type="hidden" datatype="fileLen" valu="" nullmsg="请至少上传一个文件">
                    </div>
                </div>
                <div class="hr-line-dashed"></div>
                <div class="form-group uploader-group col-sm-6" data-multiple="true" data-auto="true" data-len="0" data-size="<{$Think.UPLOAD_IMAGE_SIZE}>" >
                    <label class="col-sm-4 control-label">商标证:</label>
                    <div class="col-sm-8">
                        <!--用来存放文件信息-->
                        <div class="uploader-list"></div>
                        <a class="btn btn-dark uploader-picker" data-file="trademark_img" data-type="image"><i class="fa fa-upload"></i> 选择文件</a>
                        <span class="help-block"><i class="fa fa-info-circle"></i>最大只能上传<{$Think.UPLOAD_IMAGE_SIZE}>M的图片</span>
                    </div>
                </div>
                <div class="hr-line-dashed"></div>
                <div class="form-group uploader-group col-sm-6" data-multiple="true" data-auto="true" data-len="0" data-size="<{$Think.UPLOAD_IMAGE_SIZE}>" >
                    <label class="col-sm-4 control-label">其他:</label>
                    <div class="col-sm-8">
                        <!--用来存放文件信息-->
                        <div class="uploader-list"></div>
                        <a class="btn btn-dark uploader-picker" data-file="other_img" data-type="image"><i class="fa fa-upload"></i> 选择文件</a>
                        <span class="help-block"><i class="fa fa-info-circle"></i>最大只能上传<{$Think.UPLOAD_IMAGE_SIZE}>M的图片</span>
                    </div>
                </div>
                <div class="hr-line-dashed"></div>
                <div class="form-group">
                    <div class="col-sm-8 col-sm-offset-3">
                        <button class="btn btn-success" type="submit">提交</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
{/block}
{block name="js"}
    <script src="/static/admin/js/validform.js" type="text/javascript" ></script>
    <script src="/static/admin/js/newvalidform.js" type="text/javascript" ></script>
    <script src="/static/admin/webuploader/webuploader.min.js"></script>
    <script src="/static/admin/js/webuploader.own.js"></script>
    <script>
        $(function () {
            //页面加载的时候,如果已选择省份,则把市加载出来
            var province_id = parseInt($('#province').val());
            if(province_id > 0)
            {
                get_area_list(province_id,'city');
            }

            //搜索市
            $('#province').change(function () {
                get_area_list($(this).val(),'city');
            });

            //搜索区县
            $('#city').change(function () {
                get_area_list($(this).val(),'district');
            });
        });

        //获取省份
        function get_area_list(pid,ele_id)
        {
            $.get('<{:url("region/getRegionList")}>',{pid:pid},function (return_data) {
                if(return_data.status == 1)
                {
                    if(ele_id == 'city')
                    {
                        var select_msg = '请选择市';
                    }
                    else
                    {
                        var select_msg = '请选择区县';
                    }
                    var data = return_data.data,
                        html = '<option value="">'+select_msg+'</option>';
                    for (var k in data)
                    {
                        html += '<option value="'+data[k].id+'">'+data[k].region_name+'</option>';
                    }

                    $('#'+ele_id).html(html);
                }
            });
        }
    </script>
{/block}